<div
  class="compare-section bg-[#F6F7F9] dark:bg-gray-900 py-8 min-h-[90vh] mt-16"
>
  <div class="heading text-center py-8">
    <h2 class="text-head dark:text-white head-title text-4xl font-bold">
      Property Comparison
    </h2>
    <p class="opacity-70 text-gray-700 dark:text-gray-300">
      Compare two properties to choose the best one for your needs
    </p>
  </div>

  <div class="container mx-auto px-4 w-full sm:w-[80%]">
    @if(properties().length>0){

    <div class="comparison shadow-sm dark:bg-gray-800">
      <div class="properties grid gap-4 grid-cols-1 md:grid-cols-2 p-4 sm:p-6">
        @for (prop of properties(); track $index) {
        <div
          class="property flex flex-col justify-center items-center gap-3 relative"
        >
          <button
            (click)="this.propertiesService.RemoveFromCompare(prop.id)"
            class="absolute top-2 right-2 bg-red-500 text-white p-2 rounded-full shadow hover:bg-red-600 transition z-10 flex justify-center items-center size-8"
            title="Remove from comparison"
          >
            <i class="fa-solid fa-xmark"></i>
          </button>
          <div class="image overflow-hidden rounded-2xl w-full">
            <img
              [src]="prop.propertyImages.mainImageSrc"
              alt=""
              class="w-full h-[150px] sm:h-[200px] object-cover transition duration-300"
            />
          </div>

          <h3
            class="text-base sm:text-[20px] font-bold text-[#1F2937] dark:text-white text-center"
          >
            {{ prop.propertyTypeFullDescription }}
          </h3>
          <p
            class="opacity-50 text-gray-600 dark:text-gray-400 text-[12px] sm:text-[14px] text-center"
          >
            <span><i class="fa-solid fa-location-dot"></i></span>
            {{ prop.displayAddress }}
          </p>
        </div>
        }
      </div>

      <div class="overflow-x-auto mt-4 hidden md:block">
        <table class="w-full text-sm sm:text-base text-start min-w-[500px]">
          <thead
            class="bg-[#F7F8F9] dark:bg-gray-700 text-head dark:text-white"
          >
            <tr>
              <th class="text-start px-2 sm:px-4 py-3">Features</th>
              <th class="text-center px-2 sm:px-4 py-3 hidden sm:table-cell">
                Property A
              </th>
              <th class="text-center px-2 sm:px-4 py-3 hidden sm:table-cell">
                Property B
              </th>
            </tr>
          </thead>
          <tbody class="text-center bg-white dark:bg-gray-900">
            <tr>
              <td class="px-2 sm:px-4 py-3 text-left">
                <div
                  class="feature flex items-center gap-2 text-gray-900 dark:text-white"
                >
                  <span class="icon">
                    <svg
                      xmlns="http://www.w3.org/2000/svg"
                      width="24"
                      height="24"
                      viewBox="0 0 24 24"
                      fill="none"
                      stroke="currentColor"
                      stroke-width="2"
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      class="lucide lucide-dollar-sign w-4 h-4 text-primary"
                    >
                      <line x1="12" x2="12" y1="2" y2="22"></line>
                      <path
                        d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"
                      ></path>
                    </svg>
                  </span>
                  <span>Price</span>
                </div>
              </td>
              @for (prop of properties(); track $index) {
              <td
                class="px-2 sm:px-4 py-3 hidden sm:table-cell text-gray-900 dark:text-white"
              >
                {{ prop.price.amount | currency : "GBP" }}
              </td>
              <td
                class="px-2 sm:px-4 py-3 sm:hidden text-left font-medium text-gray-900 dark:text-white"
              >
                {{ $index === 0 ? "Property A" : "Property B" }}:
                {{ prop.price.amount | currency : "GBP" }}
              </td>
              }
            </tr>
            <tr>
              <td class="px-2 sm:px-4 py-3 text-left">
                <div
                  class="feature flex items-center gap-2 text-start text-gray-900 dark:text-white"
                >
                  <span class="icon">
                    <i class="fa-regular fa-house"></i>
                  </span>
                  <span>Property Type</span>
                </div>
              </td>
              @for (prop of properties(); track $index) {
              <td
                class="px-2 sm:px-4 py-3 hidden sm:table-cell text-gray-900 dark:text-white"
              >
                {{ prop.propertySubType }}
              </td>
              <td
                class="px-2 sm:px-4 py-3 sm:hidden text-left font-medium text-gray-900 dark:text-white"
              >
                {{ $index === 0 ? "Property A" : "Property B" }}:
                {{ prop.propertySubType }}
              </td>
              }
            </tr>
            <tr>
              <td class="px-2 sm:px-4 py-3 text-left">
                <div
                  class="feature flex items-center gap-2 text-gray-900 dark:text-white"
                >
                  <span class="icon">
                    <i class="fa-solid fa-bed"></i>
                  </span>
                  <span>Bedrooms</span>
                </div>
              </td>
              @for (prop of properties(); track $index) {
              <td
                class="px-2 sm:px-4 py-3 hidden sm:table-cell text-gray-900 dark:text-white"
              >
                {{ prop.bedrooms }}
              </td>
              <td
                class="px-2 sm:px-4 py-3 sm:hidden text-left font-medium text-gray-900 dark:text-white"
              >
                {{ $index === 0 ? "Property A" : "Property B" }}:
                {{ prop.bedrooms }}
              </td>
              }
            </tr>
            <tr>
              <td class="px-2 sm:px-4 py-3 text-left">
                <div
                  class="feature flex items-center gap-2 text-gray-900 dark:text-white"
                >
                  <span class="icon">
                    <i class="fa-solid fa-shower"></i>
                  </span>
                  <span>Bathroom</span>
                </div>
              </td>
              @for (prop of properties(); track $index) {
              <td
                class="px-2 sm:px-4 py-3 hidden sm:table-cell text-gray-900 dark:text-white"
              >
                {{ prop.bathrooms }}
              </td>
              <td
                class="px-2 sm:px-4 py-3 sm:hidden text-left font-medium text-gray-900 dark:text-white"
              >
                {{ $index === 0 ? "Property A" : "Property B" }}:
                {{ prop.bathrooms }}
              </td>
              }
            </tr>
            <tr>
              <td class="px-2 sm:px-4 py-3 text-left">
                <div
                  class="feature flex items-center gap-2 text-gray-900 dark:text-white"
                >
                  <span class="icon">
                    <svg
                      xmlns="http://www.w3.org/2000/svg"
                      width="24"
                      height="24"
                      viewBox="0 0 24 24"
                      fill="none"
                      stroke="currentColor"
                      stroke-width="2"
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      class="lucide lucide-maximize w-4 h-4 text-primary"
                    >
                      <path d="M8 3H5a2 2 0 0 0-2 2v3"></path>
                      <path d="M21 8V5a2 2 0 0 0-2-2h-3"></path>
                      <path d="M3 16v3a2 2 0 0 0 2 2h3"></path>
                      <path d="M16 21h3a2 2 0 0 0 2-2v-3"></path>
                    </svg>
                  </span>
                  <span>Area</span>
                </div>
              </td>

              @for (prop of properties(); track $index) {
              <td
                class="px-2 sm:px-4 py-3 hidden sm:table-cell text-gray-900 dark:text-white"
              >
                {{ prop.displaySize }}
              </td>
              <td
                class="px-2 sm:px-4 py-3 sm:hidden text-left font-medium text-gray-900 dark:text-white"
              >
                {{ $index === 0 ? "Property A" : "Property B" }}:
                {{ prop.displaySize }}
              </td>
              }
            </tr>
            <tr>
              <td class="px-2 sm:px-4 py-3 text-left">
                <div
                  class="feature flex items-center gap-2 text-gray-900 dark:text-white"
                >
                  <span class="icon">
                    <svg
                      xmlns="http://www.w3.org/2000/svg"
                      width="24"
                      height="24"
                      viewBox="0 0 24 24"
                      fill="none"
                      stroke="currentColor"
                      stroke-width="2"
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      class="lucide lucide-file-text w-4 h-4 text-muted-foreground"
                    >
                      <path
                        d="M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z"
                      ></path>
                      <path d="M14 2v4a2 2 0 0 0 2 2h4"></path>
                      <path d="M10 9H8"></path>
                      <path d="M16 13H8"></path>
                      <path d="M16 17H8"></path>
                    </svg>
                  </span>
                  <span>Description</span>
                </div>
              </td>
              @for (prop of properties(); track $index) {
              <td class="px-2 sm:px-4 py-3 hidden sm:table-cell">
                <p
                  class="text-xs sm:text-sm opacity-70 leading-6 text-gray-600 dark:text-gray-300 text-center"
                >
                  {{ prop.summary }}
                </p>
              </td>
              <td class="px-2 sm:px-4 py-3 sm:hidden text-left">
                <div class="font-medium mb-1 text-gray-900 dark:text-white">
                  {{ $index === 0 ? "Property A" : "Property B" }}:
                </div>
                <p
                  class="text-xs opacity-70 leading-5 text-gray-600 dark:text-gray-300"
                >
                  {{ prop.summary }}
                </p>
              </td>
              }
            </tr>
          </tbody>
        </table>
      </div>
      <div class="md:hidden mt-6 space-y-4">
        @for (prop of properties(); track $index; let i = $index) {
        <div
          class="bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-100 dark:border-gray-700 p-4"
        >
          <div class="flex items-center gap-3 mb-3">
            <div
              class="w-16 h-16 flex-shrink-0 rounded-lg overflow-hidden border border-gray-200 dark:border-gray-600"
            >
              <img
                [src]="prop.propertyImages.mainImageSrc"
                alt="Property Image"
                class="w-full h-full object-cover"
              />
            </div>
            <div>
              <h3
                class="font-semibold text-gray-800 dark:text-white text-base leading-tight"
              >
                {{ prop.propertyTypeFullDescription || "Property " + (i + 1) }}
              </h3>
              <p class="text-sm text-gray-500 dark:text-gray-400">
                {{ prop.propertySubType }}
              </p>
            </div>
          </div>

          <div
            class="divide-y divide-gray-100 dark:divide-gray-700 text-sm text-gray-700 dark:text-gray-300"
          >
            <div class="py-2 flex justify-between">
              <span class="font-medium text-gray-600 dark:text-gray-400"
                >üí∑ Price:</span
              >
              <span class="text-gray-900 dark:text-white">{{
                prop.price.amount | currency : "GBP"
              }}</span>
            </div>
            <div class="py-2 flex justify-between">
              <span class="font-medium text-gray-600 dark:text-gray-400"
                >üè† Type:</span
              >
              <span class="text-gray-900 dark:text-white">{{
                prop.propertySubType
              }}</span>
            </div>
            <div class="py-2 flex justify-between">
              <span class="font-medium text-gray-600 dark:text-gray-400"
                >üõè Bedrooms:</span
              >
              <span class="text-gray-900 dark:text-white">{{
                prop.bedrooms
              }}</span>
            </div>
            <div class="py-2 flex justify-between">
              <span class="font-medium text-gray-600 dark:text-gray-400"
                >üöø Bathrooms:</span
              >
              <span class="text-gray-900 dark:text-white">{{
                prop.bathrooms
              }}</span>
            </div>
            <div class="py-2 flex justify-between">
              <span class="font-medium text-gray-600 dark:text-gray-400"
                >üìè Area:</span
              >
              <span class="text-gray-900 dark:text-white">{{
                prop.displaySize
              }}</span>
            </div>
            <div class="py-2">
              <p
                class="text-gray-500 dark:text-gray-400 leading-relaxed text-sm"
              >
                {{ prop.summary }}
              </p>
            </div>
          </div>
        </div>
        }
      </div>
    </div>
    } @else {
    <div
      class="w-full h-[300px] flex flex-col justify-center items-center text-center"
    >
      <p class="text-xl font-semibold text-red-600 dark:text-red-400">
        No properties available for comparison
      </p>
      <p class="text-gray-400 dark:text-gray-500 mt-2">
        Please select two or more properties to compare.
      </p>
    </div>
    }
  </div>
</div>
